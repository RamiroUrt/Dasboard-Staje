<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ingreso</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="login-container">
    <h2>INGRESO</h2>
    <form id="login-form">
      <input type="email" id="email" placeholder="Correo" required>
      <input type="password" id="password" placeholder="Contraseña" required>
      <button type="submit">Ingresar</button>
    </form>

    <div id="contenido-dinamico" style="display:none;">
      <h3>NUEVAS INCORPORACIONES</h3>
      <a class="boton-link" href="" target="_blank" id="links-nuevas1">Nueva Inco A Cargo</a>
      <a class="boton-link" href="" target="_blank" id="links-nuevas2">Nueva Inco de Equipo de Líder Integra</a>

      <h3>INCORPORADORES</h3>
      <a class="boton-link" href="" target="_blank" id="links-incorpo1">Inco A Cargo</a>
      <a class="boton-link" href="" target="_blank" id="links-incorpo2">Inco de Equipo de Líder Integra</a>
    </div>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzTmw0t0zUT5bUtPI4Qrp2aUW3BdyQcV1xCe1sFDxeCbvT9F-q_wC7pByQ2fWofvL9Y/exec'; // Tu URL pública de Apps Script

    document.getElementById('login-form').addEventListener('submit', function(event) {
      event.preventDefault();

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();

      fetch(`${scriptURL}?email=${email}&contrasena=${password}`)
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            cargarLinks(data.distribuidor);
          } else {
            alert("Credenciales incorrectas");
          }
        })
        .catch(err => {
          alert("Error al conectar con el servidor");
          console.error(err);
        });
    });

    function cargarLinks(distribuidor) {
      fetch(`${scriptURL}?distribuidor=${encodeURIComponent(distribuidor)}`)
        .then(res => res.json())
        .then(data => {
          const filas = data.rows;

          // Asigna los primeros links de cada sección según el orden
          document.getElementById('links-nuevas1').href = filas[0][3]; // suponiendo que columna 3 = enlace
          document.getElementById('links-nuevas2').href = filas[1][3];
          document.getElementById('links-incorpo1').href = filas[2][3];
          document.getElementById('links-incorpo2').href = filas[3][3];

          document.getElementById('contenido-dinamico').style.display = 'block';
          document.getElementById('login-form').style.display = 'none';
        })
        .catch(err => {
          alert("Error al obtener los datos filtrados");
          console.error(err);
        });
    }
  </script>
</body>
</html>
